{% extends "base.html" %}
{% block content %}

<h2 class="fw-bold text-center mb-4">Scan Voucher QR</h2>

<div class="text-center">

    <div style="width: 320px; height: 320px; margin:auto; border: 3px solid #4da8ff; border-radius: 20px; position: relative;">

        <video id="camera" width="314" height="314" style="border-radius: 16px;"></video>

        <div style="position:absolute; top:10px; left:10px; right:10px; bottom:10px;
                    border: 2px dashed #4da8ff; border-radius: 15px;">
        </div>
    </div>

    <p class="mt-3 text-muted">Point your camera at the QR code</p>
</div>

<script src="https://unpkg.com/html5-qrcode"></script>

<script>
    const scanner = new Html5Qrcode("camera");

    function startScanner() {
        Html5Qrcode.getCameras().then(cameras => {
            if (cameras.length > 0) {
                scanner.start(
                    cameras[0].id,
                    { fps: 10, qrbox: 250 },
                    qr => window.location.href = "/redeem/" + qr
                );
            }
        });
    }

    startScanner();
</script>

{% endblock %}